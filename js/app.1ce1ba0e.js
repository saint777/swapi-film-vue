(function(t){function a(a){for(var i,o,c=a[0],r=a[1],l=a[2],h=0,f=[];h<c.length;h++)o=c[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);u&&u(a);while(f.length)f.shift()();return s.push.apply(s,l||[]),e()}function e(){for(var t,a=0;a<s.length;a++){for(var e=s[a],i=!0,c=1;c<e.length;c++){var r=e[c];0!==n[r]&&(i=!1)}i&&(s.splice(a--,1),t=o(o.s=e[0]))}return t}var i={},n={app:0},s=[];function o(a){if(i[a])return i[a].exports;var e=i[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=t,o.c=i,o.d=function(t,a,e){o.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,a){if(1&a&&(t=o(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var i in t)o.d(e,i,function(a){return t[a]}.bind(null,i));return e},o.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(a,"a",a),a},o.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=a,c=c.slice();for(var l=0;l<c.length;l++)a(c[l]);var u=r;s.push([0,"chunk-vendors"]),e()})({0:function(t,a,e){t.exports=e("56d7")},"2a12":function(t,a,e){},"30b0":function(t,a,e){"use strict";var i=e("db38"),n=e.n(i);n.a},3962:function(t,a,e){"use strict";var i=e("2a12"),n=e.n(i);n.a},"39b5":function(t,a,e){"use strict";var i=e("a79c"),n=e.n(i);n.a},"3ea9":function(t,a,e){t.exports=e.p+"img/loading-anim.b97ec604.svg"},"56d7":function(t,a,e){"use strict";e.r(a);e("cadf"),e("551c"),e("f751"),e("097d");var i,n=e("2b0e"),s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"container"},[e("catalog",{attrs:{title:"Каталог",loadLimit:3}})],1)])},o=[],c=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"catalog"},[i("div",{staticClass:"catalog__title-wrap"},[i("h1",{staticClass:"catalog__title"},[t._v(t._s(t.title))]),t.isBusy?i("img",{staticClass:"catalog__status",attrs:{src:e("3ea9")}}):t._e()]),i("catalogSearchbar",{staticClass:"catalog__searchbar",attrs:{action:t.request}}),i("div",{staticClass:"catalog__list"},[t._l(t.movies,function(t){return i("catalog-item",{key:t.url,attrs:{movie:t}})}),t.message.length>0?i("p",{staticClass:"catalog__message"},[t._v(t._s(t.message))]):t._e()],2),i("div",{staticClass:"text-center"},[t.isEnd?t._e():i("catalogButton",{staticClass:"catalog__btn-loadmore",attrs:{text:"Показать еще",action:t.loadMore}})],1)],1)},r=[],l=(e("7514"),e("ac6a"),e("4f7f"),e("5df3"),e("1c4c"),e("6762"),e("2fdb"),e("c5f6"),e("bc3a")),u=e.n(l),h=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"catalog-item"},[e("div",{staticClass:"catalog-item__image-wrap"},[t.isImageLoading?e("div",{staticClass:"catalog-item__loader"}):t._e(),e("img",{staticClass:"catalog-item__image",attrs:{src:t.itemImage}})]),e("div",{staticClass:"catalog-item__info"},[e("p",{staticClass:"catalog-item__title"},[t._v(t._s(t.movie.title))]),e("p",{staticClass:"catalog-item__director"},[t._v(t._s(t.movie.director))])])])},f=[],m=(e("a481"),{name:"catalogItem",props:{movie:Object,message:String},data:function(){return{isImageLoading:!1,itemImage:""}},methods:{searchImage:function(){this.isImageLoading=!0;var t=this;u.a.get("https://pixabay.com/api/?key=13445987-aabf208eb8d891b48efe137e0&image_type=all&q=".concat(this.movie.title.replace(" ","+")),{timeout:1e4}).catch(function(){t.itemImage="https://via.placeholder.com/258x84.png?text=ERROR",t.isImageLoading=!1}).then(function(a){a.data.hits.length>0?t.itemImage=a.data.hits[0].webformatURL:t.itemImage="https://via.placeholder.com/258x84.png?text=Placeholder",t.isImageLoading=!1})}},mounted:function(){this.searchImage()},created:function(){this.searchImage()}}),p=m,d=(e("7574"),e("2877")),g=Object(d["a"])(p,h,f,!1,null,null,null),v=g.exports,_=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{staticClass:"searchbar"},[e("div",{staticClass:"searchbar__icon"}),e("input",{staticClass:"searchbar__input",attrs:{placeholder:"Введите название"},on:{input:function(a){return t.doAction(a.target.value)}}})])},b=[],y={name:"catalog-searchbar",props:{action:Function,delay:Number},data:function(){return{doAction:function(t){var a=this;clearTimeout(i),i=setTimeout(function(){a.action(t)},500)}}}},C=y,j=(e("3962"),Object(d["a"])(C,_,b,!1,null,null,null)),x=j.exports,w=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("button",{staticClass:"catalog-btn",on:{click:t.action}},[t._v(t._s(t.text))])},O=[],I={name:"catalog-btn",props:{text:String,action:Function}},E=I,S=(e("30b0"),Object(d["a"])(E,w,O,!1,null,null,null)),B=S.exports,L={name:"catalog",props:{title:String,loadLimit:Number},components:{catalogItem:v,catalogSearchbar:x,catalogButton:B},data:function(){return{movies:[],jsonData:[],cache:[],totalCount:0,isBusy:!1,isEnd:!1,limitPerLoad:this.loadLimit,message:""}},created:function(){this.init()},methods:{init:function(){var t=this,a=this;this.isBusy=!0,u.a.get("https://swapi.co/api/films/",{timeout:1e4}).catch(function(a){t.message="Ошибка загрузки — ".concat(a),t.isBusy=!1,t.isEnd=!0}).then(function(e){a.jsonData=e.data.results,t.totalCount=e.data.count,t.isBusy=!1,t.isEnd=!1,t.loadMore()})},searchByQuery:function(t,a){return""!==a?t.filter(function(t){var e=String(t.title).toLowerCase();return e.includes(String(a).toLowerCase())}):t},request:function(t){var a=this;this.isBusy=!0;var e=this;this.cache.length>0&&(this.movies=this.searchByQuery(this.cache,t),this.isBusy=!1),this.cache.length<this.totalCount&&u.a.get("https://swapi.co/api/films/?search=".concat(t),{timeout:1e4}).catch(function(t){a.message="Ошибка загрузки — ".concat(t),a.isBusy=!1,a.isEnd=!0}).then(function(t){e.jsonData=t.data.results,a.isBusy=!1,a.isEnd=!1,a.movies=[],a.loadMore()}),this.movies.length===this.totalCount&&(this.isEnd=!0)},updateCache:function(t){this.cache=Array.from(new Set(this.cache.concat(t))),this.cache=this.cache.reduce(function(t,a){var e=t.find(function(t){return t.url===a.url});return e?t:t.concat([a])},[])},loadMore:function(){var t=this.jsonData.length,a=this.limitPerLoad;if(t>=a)for(var e=0;e<a;e+=1)this.movies.push(this.jsonData.pop());else if(t<a){for(var i=0;i<t;i+=1)this.movies.push(this.jsonData.pop());this.isEnd=!0}this.updateCache(this.movies)}}},P=L,M=(e("39b5"),Object(d["a"])(P,c,r,!1,null,null,null)),k=M.exports,D={name:"app",components:{catalog:k}},$=D,T=(e("5c0b"),Object(d["a"])($,s,o,!1,null,null,null)),R=T.exports,q=e("2f62");n["a"].use(q["a"]);var A=new q["a"].Store({state:{},mutations:{},actions:{}});n["a"].config.productionTip=!1,new n["a"]({store:A,render:function(t){return t(R)}}).$mount("#app")},"5c0b":function(t,a,e){"use strict";var i=e("e332"),n=e.n(i);n.a},"74ac":function(t,a,e){},7574:function(t,a,e){"use strict";var i=e("74ac"),n=e.n(i);n.a},a79c:function(t,a,e){},db38:function(t,a,e){},e332:function(t,a,e){}});
//# sourceMappingURL=app.1ce1ba0e.js.map